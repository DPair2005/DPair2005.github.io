<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link rel="stylesheet" type="text/css" href="/css/art.css">
    <link rel="icon" type="images/png" href="/images/favicon.png">
    <script src="/js/header.js"></script>
<script src="/js/search.js"></script>
<script src="/js/theme.js"></script>
<script src="/js/hitokoto.js"></script>

    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.2.0/build/styles/atom-one-light.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.2.0/build/highlight.min.js"></script>
    <script src="/js/language.min.js"></script>
    <title>
        杂题选做 - DPairの非自制 blog
    </title>
</head>

<body>
        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/load_theme.js"></script>

    <script>
        window.onload = function() {
            loadMath();
            drawSaying();
            hljs.configure({ tabReplace: '    ' });
            hljs.highlightAll()
        }
    </script>

    <div class="content">
        <div class="sidebar" id="sidebar">
            <script>
    document.heartland = false;
    window.localStorage.setItem('heartland', false);
</script>

<div class="sidebar-title">
    <p style="font-weight: bold; font-size: 25px; font-family: 'ZCOOL XiaoWei';" onclick="drawSaying()"> 
    DPairの非自制 blog
    </p>
    <hr align="center" style="width: 200px;">
    <p></p>
    <div font style="text-align: center; font-size: 18px; font-family: 'ZCOOL XiaoWei';" class="sayingtype" id="sayingtype"> </div>
    <div font="" style="text-align: center; font-size: 6px;"> 　 </div>
    <div class="saying" id="saying"> </div>
</div>


<div class="sidebar-body">

    <div class="sidebar-content">
        <ul class="sidebar-menu">
            <a href="/">
                <li class="list-item sidebar-menu-item" id="sidebar-content-home">
                    Home
                </li>
            </a>
            <a href="/articles">
                <li class="list-item sidebar-menu-item" id="sidebar-content-articles" style="background: #e5e5e5">
                    Articles
                </li>
            </a>
            <a href="/tags">
                <li class="list-item sidebar-menu-item" id="sidebar-content-tags">
                    Tags
                </li>
            </a>
        </ul>
    </div>

    <div class="sidebar-about">
    <div style="text-align: center; font-size: 16px;">
        <a href="/aboutme" style="text-decoration: none; color: currentColor;">
            About me
        </a>
    </div>
    <HR align="center">
    <div class="avatar-rotate" style="margin: 2 auto; width: min-content">
        <img class="avatar" alt="DPair" src="/images/avatar.png", onclick="NextBackground()"></img>
    </div>

    <ul class="sidebar-links">
    <li class="sidebar-links-item">
        <a href="https://dpair2005.github.io" class="friend-link">
            github blog 
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://dpair.gitee.io" class="friend-link">
            gitee blog 
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://www.luogu.com.cn/blog/DPair2005/" class="friend-link">
            luogu blog 
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://codeforces.com/profile/DPair" class="friend-link">
            Codeforces 
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://atcoder.jp/users/DPair" class="friend-link">
            AtCoder 
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://github.com/DPair2005" class="friend-link">
            github 
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://gitee.com/DPair" class="friend-link">
            gitee 
        </a>
    </li>
    </ul>

</div>

<ul class="sidebar-links">
    <div style="text-align: center; font-size: 16px;"> links </div>
    <HR align="center">

    <li class="sidebar-links-item">
        <a href="https://coderoj.gitee.io/" class="friend-link">
            Jacder's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://xyix.github.io/" class="friend-link">
            xYix's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://www.cnblogs.com/flying2018" class="friend-link">
            flying2018's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://www.cnblogs.com/Point-King/" class="friend-link">
            Point_King's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://cnblogs.com/pealfrog" class="friend-link">
            xtw's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="http://xyf007.ml/" class="friend-link">
            xyf007's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://www.cnblogs.com/zkdxl" class="friend-link">
            zkdxl's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://www.cnblogs.com/guts" class="friend-link">
            krimson's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://blog.moonpie.cf/" class="friend-link">
            moonpie's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://www.luogu.com.cn/blog/wh2005blog/" class="friend-link">
            wuhao2005's blog
        </a>
    </li>
<li class="sidebar-links-item">
        <a href="https://blog.jasonfan.ml/" class="friend-link">
            jasonfan's blog
        </a>
    </li>

</ul>



</div>
        </div>

        <div class="post" id="post">
            <h1>杂题选做</h1>
            <p>主要是我觉得做完题还是得写写题解（（</p>
<h3 id="-cf1025d-recovering-bst-https-www-luogu-com-cn-problem-cf1025d"><a href="https://www.luogu.com.cn/problem/CF1025D">CF1025D Recovering BST</a></h3>
<p>给你一个序列，问你能否对其构建一棵二叉搜索树，使得有边相连的结点都不互质。</p>
<p>$n \le 700$</p>
<details>
<summary> 具体解法 </summary>
  <p>首先有一个朴素的 dp， 是 $\mathcal{O}(n^4)$ 的</p>
<p>注意到它要多次枚举儿子所以多了一个 $\mathcal{O}(n)$，但也导致了重复运算</p>
<p>因此考虑换一个方向，由儿子确定父亲，或者说在儿子处就确定好一些东西</p>
<p>具体来说，我们在父亲处的做法是枚举所有可能的根，然后对应这个根枚举所有可能的儿子区间及其对应的根，这样我们要枚举两次根</p>
<p>但是我们注意到在儿子处枚举时，其父亲结点可能的根不是 $l-1$ 就是 $r+1$，因此可以少枚举一次根</p>
<p>这样子的话就可以省一维</p>
<p>还是比较有启发性的</p>

</details>


<h3 id="-cf449d-jzzhu-and-numbers-https-www-luogu-com-cn-problem-cf449d"><a href="https://www.luogu.com.cn/problem/CF449D">CF449D Jzzhu and Numbers</a></h3>
<p>给你一个可重集合，问你有多少个方案选出一个非空子集使得其按位与的结果为 $0$。</p>
<p>$n, a \le 10^6$</p>
<details>
<summary> 具体解法 </summary>
  <p>我们考虑朴素的做法，列出其方程：</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{i,S}&=f_{i-1,S}+\sum_{j \operatorname{and} a_i=S} f_{i-1,j} \\
&=f_{i-1,S}+\sum_{j \operatorname{and} k=S} f_{i-1,j} \times [k=a_i]
\end{aligned}</script><p>注意到这是一个与卷积的形式，因此考虑 FWT。</p>
<p>然而暴力的 FWT 复杂度还是不对，不过注意到每一次 FWT 前只有 $a_i$ 这一位是 $1$。</p>
<p>手模一下 FWT 的过程不难发现， FWT 之后每一位仍然最多是 $1$，因此卷起来之后所有为 $1$ 的位置的 $f$ 都会翻倍。</p>
<p>因此我们考虑把所有 FWT 的过程加起来一起算，那么每一位的最终结果就是 $2^x$。</p>
<p>然后还要 FWT 回去，最终答案就是 $f_0$。</p>
<p>另外注意到全 $0$ 的时候会多算一个空集，去掉就好。</p>
<p>复杂度 $\mathcal{O}(n\log n)$。</p>

</details>


<h3 id="-cf1453f-even-harder-https-www-luogu-com-cn-problem-cf1453f"><a href="https://www.luogu.com.cn/problem/CF1453F">CF1453F Even Harder</a></h3>
<p>给定数组 $a$，$a_i$ 表示从 $i$ 能走到 $[i+1, i+a_i]$，问至少要把多少个 $a_i$，改成 $0$，才能使得 $1$ 到 $n$ 有且仅有一条路径。</p>
<p>$n \leq 3000$。</p>
<details>
<summary> 具体解法 </summary>
  <p>一眼 DP，然后发现直接处理 $a$ 序列不是很好搞。</p>
<p>注意到最终只剩下一条路径，因此可以直接对最后的跳跃序列跑 DP。</p>
<p>考虑设 $f_{i,j}$ 表示 $i, j$ 为跳跃序列最后两个元素要删除的 $j$ 之前的点的个数。</p>
<p>考虑转移：（默认 $i$ 能到达 $j$，不能到达直接设为 $\infty$）</p>
<script type="math/tex; mode=display">
f_{i,j}=\min_{k\in[1,i)\land j>(a_k+k)}\{f_{k,i}\}+\sum_{p=i+1}^{j-1}[p+a_p\ge j]</script><p>这个式子显然 $\mathcal{O}(n^3)$，因此考虑优化。</p>
<p>后面一项很好处理，我们考虑前一项的处理方式。</p>
<p>然后我们考虑 $k$ 合法的条件，首先发现 $k$ 是一个 $[1,i)$ 区间内的前缀。</p>
<p>我们考虑枚举 $k$，然后拿它对所有 $j &gt; (a_k+k)$ 产生贡献，注意到这是一个后缀。</p>
<p>因此可以考虑在对应的 $(a_k+k)+1$ 上打上 tag 然后用前缀 $\min$ 的方式贡献所有合法的位置。</p>
<p>最后递推地把第二项加上就行，复杂度 $\mathcal{O}(n^2)$。</p>

</details>


<h3 id="-cf1085d-minimum-diameter-tree-https-www-luogu-com-cn-problem-cf1085d"><a href="https://www.luogu.com.cn/problem/CF1085D">CF1085D Minimum Diameter Tree</a></h3>
<p>给你一棵 $n$ 个结点的树，你有一个数 $s$。</p>
<p>你要给每一条边分配一个边权，保证边权为 <strong>正实数</strong>，使得边权之和为 $s$。</p>
<p>最小化直径。</p>
<p>$n \le 10^5$</p>
<details>
<summary> 具体解法 </summary>
  <p>显然直径产生于两个叶子之间。</p>
<p>我们要做的是尽可能的把边权均摊掉，因此我们不妨随便取一个点作为根然后看看贪心策略。</p>
<p>注意到如果一条边不连接叶子，那么它会使得多个叶子深度增加，这显然没有取在与叶子相连的边上优。</p>
<p>因此答案就是 $s$ 平均分给每一个叶子的返祖边，然后 $\times 2$ 即可。</p>

</details>


<h3 id="-cf1526d-kill-anton-https-www-luogu-com-cn-problem-cf1526d"><a href="https://www.luogu.com.cn/problem/CF1526D">CF1526D Kill Anton</a></h3>
<p>给定一个字符串a，你可以任意打乱a中字符的顺序，记打乱后的字符串为b。记b的价值为将b转换为a所需的最小交换次数（交换指交换两个相邻元素）。输出b使得b的价值最大。</p>
<p>若有多种答案，任意输出一种。</p>
<details>
<summary> 具体解法 </summary>
  <p>首先有个结论是答案中相同的字符相邻严格不劣。</p>
<p>那么做已经很好做了，直接枚举全排列求个逆序对取个 $\max$ 就行。</p>
<p>假设原序列中只有两种字符，显然这个结论可以扩展到多种字符时。</p>
<p>考虑此时交换次数是什么，我们不妨选择其中一个字符为关键字符 $key$，那么答案就是两个序列的这玩意儿：</p>
<script type="math/tex; mode=display">
\sum_{i=1}^n[a_i=key]\times \left(\sum_{j=i+1}^n [a_i\ne key]\right)</script><p>的差值的绝对值。</p>
<p>显然这东西的上下界是就是所有相同字符相邻的那两种情况，显然存在其中一种与原序列差值最大。</p>

</details>


<h3 id="-at2005-agc003e-sequential-operations-on-sequence-https-www-luogu-com-cn-problem-at2005"><a href="https://www.luogu.com.cn/problem/AT2005">AT2005 [AGC003E] Sequential operations on Sequence</a></h3>
<p>一串数，初始为 $1\sim n$，现在给 $Q$ 个操作，每次操作把数组长度变为 $q_i$，新增的数为上一个操作后的数组的重复。问 $Q$ 次操作后 $1\sim n$ 每个数出现了多少次。</p>
<p>$n, Q \le 10^5$</p>
<details>
<summary> 具体解法 </summary>
  <p>首先注意到 $a_i \ge a_{i+1}$ 的位置没有意义，因此可以考虑把序列缩成一个上升子序列。</p>
<p>考虑每一项就是上一项翻几倍然后多出来一小节，翻倍可以考虑从后往前逆推，最后求出最后一项到底是第一项翻了几倍。</p>
<p>然后考虑多出来的一小节，我们考虑直接把它截下来然后插入到序列当中，那么只需要找到它的前驱即可，具体实现的时候可以直接暴力递归。</p>
<p>注意到每一次这一小节都是对上一项取模，因此最多 $\mathcal{O}(\log n)$ 次，总复杂度就是 $\mathcal{O}(\log^2 n)$。</p>

</details>


<h3 id="-cf1056e-check-transcription-https-www-luogu-com-cn-problem-cf1056e"><a href="https://www.luogu.com.cn/problem/CF1056E">CF1056E Check Transcription</a></h3>
<p>有两个串 $t,s$，其中 $t$ 是一个 $01$ 串，$s$ 是一个由小写字母构成的字符串。</p>
<p>问有多少个字符串的二元组 $(r_0, r_1)$ 使得把 $t$ 中所有 $0$ 替换成 $r_0$，$1$ 替换成 $r_1$ 后与 $s$ 相等，且 $r_0 \ne r_1$。</p>
<p>$|t|\le 10^5, |s| \le 10^6$</p>
<details>
<summary> 具体解法 </summary>
  <p>首先我们不难发现， $t$ 串的开头那个字符一定对应的是 $s$ 串的一个前缀。因此我们只需要枚举这个字符对应串的长度就可以唯一确定它对应的串。</p>
<p>然后我们注意到 $t$ 串中 $0/1$ 的出现次数我们都可以知道，我们又知道了某个字符的长度，那么另一个字符对应串的长度我们也能确定。</p>
<p>考虑我们扫一遍 $t$ 串，由于每一个字符对应的字符串长度我们都已知，因此若我们 $\mathcal{O}(|t|)$ 扫一遍 $t$ 串，就可以求出每一个字符在 $s$ 串中对应的 <strong>起始位置</strong>。</p>
<p>再加上我们确定的长度，每一个字符在 $s$ 中对应的串我们可以通过哈希 $\mathcal{O}(1)$ 求得，因此我们得到了一个 $\mathcal{O}(|t|)$ 判断一组长度是否合法的算法。</p>
<p>但是这样看起来还是 $\mathcal{O}(|s||t|)$ 的，不过注意到在 $t$ 串中，出现次数更多的那一个字符的出现次数一定 $\ge \frac{|t|}{2}$。</p>
<p>因此我们枚举这一个字符，显然另一个字符的长度还是可以 $\mathcal{O}(1)$ 求，而且我们枚举的上界只需要达到 $\mathcal{O}(\frac{|s|}{|t|})$。</p>
<p>因此最终复杂度分析出来是 $\mathcal{O}(\frac{|s|}{|t|})\times\mathcal{O}(|t|)=\mathcal{O}(|s|)$ 的。</p>

</details>


<h3 id="-p4747-cerc2017-intrinsic-interval-https-www-luogu-com-cn-problem-p4747"><a href="https://www.luogu.com.cn/problem/P4747">P4747 [CERC2017]Intrinsic Interval</a></h3>
<p>给定一个长度为 $n$ 的排列，有 $q$ 组询问，每次询问一个区间，求一个最小的区间使得该区间包含询问区间且值域上连续，输出区间长度。</p>
<p>$n, q \le 10^5$</p>
<details>
<summary> 具体解法 </summary>

</details>
            

        </div>

    </div>
</body>