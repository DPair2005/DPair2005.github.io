---
title: 超现实数与博弈
tags:
  - magic
  - games
  - math
  - essay
---

## 0 前言
退役前的这几天被各种高质量好题折磨得要死要活，一点做题兴趣都没有，索性看点不会考的东西就当最后感受一下 OI 生活的美好

然后在翻 Matrix67 大神的博客的时候翻到了这玩意儿，看了看感觉挺神的，然后想起 x义x 也写过这玩意儿，顺便参考了一下，算是大致对超现实数这块内容有了一个很浅显的理解。

这里也把这两篇博客推荐给大家，写得肯定比我不知道好到哪里去了，我在写本文的过程中也很大程度上参考（~~复读~~）了这两篇文章：
+ [《实数、超实数和博弈游戏：数学的结构之美》 by Matrix67](http://www.matrix67.com/blog/archives/6333)
+ [《超现实数学习笔记》](https://xyix.github.io/posts/?postname=surreal-number)

OI 界中的超现实数在 2009 年集训队论文和 2021 年集训队论文中也都出现了，大家可以去看看。

如果本文有什么问题或者不严谨的地方还请尽快指出，我会在能力范围内做到尽快回复，具体联系方式可以在侧边栏的 About Me 中找到。

~~我感觉我废话好多啊~~

## 1 不平等博弈
我们先不谈超现实数，来讲讲不平等博弈。
### 1.1 一个游戏
为了方便叙述，我们称不平等博弈的一个状态为一个 **棋局**。另外，我们钦定参与博弈的两个玩家分别是 Alice 和 Bob，不过这里我们 **并没有确定先后手**，因此先手既可能是 Alice 也可能是 Bob。

然后我们假设有这样的一个游戏：

有若干堆堆成一列的积木，每一块积木上写着 A 或者 B。

每一次轮到 Alice 操作时，Alice 需要选择一块写着 A 的积木，并移除它与它上方的所有积木；Bob 的操作类似，只不过能选择的积木上需要写着 B。

最后谁不能行动，谁就失败了。

为了方便读者更直观地理解这个游戏，我们这里先举个简单的例子，一个棋局可能长成这个样子（为了方便，每一行从左到右表示一堆积木从下到上的状态）：
```
AABAA
ABAA
BB
```
然后比如说此时是 Alice 行动，那么一种可行的操作就是选择第一行的第二块积木（不一定最优），那么就会变成这样：
```
A
ABAA
BB
```
然后就轮到 Bob 行动，就这样依次类推直到一方不能行动。

### 1.2 一些棋局
那么我们现在已经对这个游戏有一个大致的了解了，不妨先看几个棋局。

例如一个这样的棋局：
```
AAAAAAAAAAAAAAA
```
它显然对 Alice 有利，因为无论谁先手谁后手 Alice 一定是必胜的。

但同时也存在这样的棋局：
```
A
B
```
我们注意到这个棋局是 **后手必胜** 的，这个应该不难思考。

更特殊一点，这样一个空的棋局也是后手必胜的。

不过还存在这样的棋局：
```
BAAAAAAAAAAAAAAA
```
我们不难发现这是 Bob 必胜的，因为无论如何 Bob 取完后 Alice 一定无法继续行动了。

另外，先手必胜的棋局当然也存在，一个比较耍赖的例子就是这样的棋局：
```
[AB]
```
即一个积木上又写了 A 又写了 B，那么谁先手谁赢。
### 1.3 一些想法
首先我们不难发现，游戏双方本身是不平等的，显然有时 Alice 必胜，有时 Bob 必胜，有时先手必胜，有时后手必胜。

不平等博弈和我们平时在 OI 中见到的博弈问题的一个明显区别在于，不平等博弈的结果是 **和玩家有关的**。

然后我们分析上面的一些棋局，我们会有一个很直观的感受：棋子更多的那一方优势更大，棋子更靠前的那一方优势更大。

不过这个直观的感受显然过于抽象化，但它同时也启发我们我们应该要有一个更为具体化形式化的表达来判断一个棋局到底是先手必胜还是后手必胜，或者是 Alice 和 Bob 中的一个必胜。

我们不妨先考虑这样一个比较简单的棋局：
```
AAAAA
BB
B
B
```
这个棋局显然有 Alice 必胜，而且由于 A 和 B 两两并不出现在同一堆中，因此这个游戏打的完全就是字母个数。

注意到我们在判断这个特殊棋局的胜负情况的过程中，我们可以把 A 看成 $1$，B 看成 $-1$，那么其实我们已经有了一种刻画这种特殊棋局的方式：就是判断 $5-2-1-1=1$ 与 $0$ 的大小关系。在这个例子中 $1$ 是个正数，因此 Alice 必胜。

那么我们很容易想到把上面这个例子中的 A 去掉一个，变成：
```
AAAA
BB
B
B
```
它的结果算出来恰好是 $0$，然后我们不难发现这个棋局是 **后手必胜** 的。

因此我们会有一个很巧妙的构思：对于每一个棋局，我们可以以某种方式刻画出一个数值，然后用这个数值与 $0$ 比较大小来判断胜负情况。
### 1.4 更一般的情况
我们考虑这样的一个不那么特殊的棋局：
```
AB
```
注意到这个棋局 Alice 其实是必胜的，但是我们如果直接套用上面那种刻画的话出来的结果会是 $1-1=0$ 这种东西，因此我们大胆猜测一个 AB 交错的行的值并不是 A-B 这种形式，而是一个更为特殊的东西。

我们现在只能确定它的值是一个正数。

然后再考虑这样一个棋局：
```
AB
B
```
这下 Bob 就可以必胜了，但是不难发现，Bob 如果是先手的话，现在第一步只能选择 A 后面那个 B，感性上似乎没有刚才那种纯拼字母个数赢得轻松。

不过我们也能确定这个棋局的值是一个负数。

我们不妨假设 AB 的值为 $x$，那么我们有一个不等式组：
$$
\begin{aligned}
x&>0\\
x-1&<0
\end{aligned}
$$
因此我们猜测， $x$ 应该是一个介于 $(0, 1)$ 间的数，我们会发现确实如此。

因为我们可以考虑这种情况：
```
AB
AB
B
```
我们手模一下就会发现 Alice 先手时一定会转化为刚才那种 Bob 必胜的情况，而 Bob 先手时 Alice 也有策略可以必胜，我们惊奇地发现这是个 **后手必胜** 的棋局。

根据我们上面那套理论来分析的话，这个棋局的值应该是 $0$。

那么得到 $2x-1=0$，所以 $x=\frac{1}{2}$。或者说，这部分提到的前两个棋局的胜者都只赢了 **半步**。

那么我们不妨猜想：
```
AB
AB
AB
B
```
这个棋局是 Alice 将以半步优势取胜，事实上 Alice 确实有必胜策略，而这个棋局的值就是 $\frac{1}{2}+\frac{1}{2}+\frac{1}{2}-1=\frac{1}{2}>0$。

但是，这其实是十分 **不严谨** 的，因为我们一直没有一个严谨的证明来告诉我们对棋局这么加加减减是正确的。

但多试验几次之后我们发现这些棋局居然真的可以进行加减操作并且判断不出错，这不由得让我们思考：**“一个博弈棋局与实数之间是否存在某些联系？”**

那么，我们现在的任务就是 **找到一种映射关系，使得我们能够说明棋局与某个数域之间是同构的。**

## 2 超现实数
咕咕咕，写不动了，等下辈子吧